import _win32typing
import win32com.client
from _typeshed import Incomplete

# Re-export everything from win32comext/adsi/adsi.pyd
# Not using a star export because the redefinitions below mess up mypy, pyright and stubtest
from win32comext.adsi.adsi import (
    DBPROPSET_ADSISEARCH as DBPROPSET_ADSISEARCH,
)
from win32comext.adsi.adsi import (
    ADsBuildEnumerator as ADsBuildEnumerator,
)
from win32comext.adsi.adsi import (
    ADsEnumerateNext as ADsEnumerateNext,
)
from win32comext.adsi.adsi import (
    ADsGetLastError as ADsGetLastError,
)
from win32comext.adsi.adsi import (
    CLSID_AccessControlEntry as CLSID_AccessControlEntry,
)
from win32comext.adsi.adsi import (
    CLSID_AccessControlList as CLSID_AccessControlList,
)
from win32comext.adsi.adsi import (
    CLSID_ADsDSOObject as CLSID_ADsDSOObject,
)
from win32comext.adsi.adsi import (
    CLSID_DsObjectPicker as CLSID_DsObjectPicker,
)
from win32comext.adsi.adsi import (
    CLSID_SecurityDescriptor as CLSID_SecurityDescriptor,
)
from win32comext.adsi.adsi import (
    DBGUID_LDAPDialect as DBGUID_LDAPDialect,
)
from win32comext.adsi.adsi import (
    DSOP_SCOPE_INIT_INFOs as DSOP_SCOPE_INIT_INFOs,
)
from win32comext.adsi.adsi import (
    IID_IADs as IID_IADs,
)
from win32comext.adsi.adsi import (
    IID_IADsClass as IID_IADsClass,
)
from win32comext.adsi.adsi import (
    IID_IADsCollection as IID_IADsCollection,
)
from win32comext.adsi.adsi import (
    IID_IADsComputer as IID_IADsComputer,
)
from win32comext.adsi.adsi import (
    IID_IADsComputerOperations as IID_IADsComputerOperations,
)
from win32comext.adsi.adsi import (
    IID_IADsContainer as IID_IADsContainer,
)
from win32comext.adsi.adsi import (
    IID_IADsDeleteOps as IID_IADsDeleteOps,
)
from win32comext.adsi.adsi import (
    IID_IADsDomain as IID_IADsDomain,
)
from win32comext.adsi.adsi import (
    IID_IADsFileService as IID_IADsFileService,
)
from win32comext.adsi.adsi import (
    IID_IADsFileServiceOperations as IID_IADsFileServiceOperations,
)
from win32comext.adsi.adsi import (
    IID_IADsFileShare as IID_IADsFileShare,
)
from win32comext.adsi.adsi import (
    IID_IADsGroup as IID_IADsGroup,
)
from win32comext.adsi.adsi import (
    IID_IADsLocality as IID_IADsLocality,
)
from win32comext.adsi.adsi import (
    IID_IADsMembers as IID_IADsMembers,
)
from win32comext.adsi.adsi import (
    IID_IADsNamespaces as IID_IADsNamespaces,
)
from win32comext.adsi.adsi import (
    IID_IADsO as IID_IADsO,
)
from win32comext.adsi.adsi import (
    IID_IADsOpenDSObject as IID_IADsOpenDSObject,
)
from win32comext.adsi.adsi import (
    IID_IADsOU as IID_IADsOU,
)
from win32comext.adsi.adsi import (
    IID_IADsPrintJob as IID_IADsPrintJob,
)
from win32comext.adsi.adsi import (
    IID_IADsPrintJobOperations as IID_IADsPrintJobOperations,
)
from win32comext.adsi.adsi import (
    IID_IADsPrintQueue as IID_IADsPrintQueue,
)
from win32comext.adsi.adsi import (
    IID_IADsPrintQueueOperations as IID_IADsPrintQueueOperations,
)
from win32comext.adsi.adsi import (
    IID_IADsProperty as IID_IADsProperty,
)
from win32comext.adsi.adsi import (
    IID_IADsPropertyList as IID_IADsPropertyList,
)
from win32comext.adsi.adsi import (
    IID_IADsResource as IID_IADsResource,
)
from win32comext.adsi.adsi import (
    IID_IADsSearch as IID_IADsSearch,
)
from win32comext.adsi.adsi import (
    IID_IADsService as IID_IADsService,
)
from win32comext.adsi.adsi import (
    IID_IADsServiceOperations as IID_IADsServiceOperations,
)
from win32comext.adsi.adsi import (
    IID_IADsSession as IID_IADsSession,
)
from win32comext.adsi.adsi import (
    IID_IADsSyntax as IID_IADsSyntax,
)
from win32comext.adsi.adsi import (
    IID_IADsUser as IID_IADsUser,
)
from win32comext.adsi.adsi import (
    IID_IDirectoryObject as IID_IDirectoryObject,
)
from win32comext.adsi.adsi import (
    IID_IDirectorySearch as IID_IDirectorySearch,
)
from win32comext.adsi.adsi import (
    IID_IDsObjectPicker as IID_IDsObjectPicker,
)
from win32comext.adsi.adsi import (
    LIBID_ADs as LIBID_ADs,
)
from win32comext.adsi.adsi import (
    StringAsDS_SELECTION_LIST as StringAsDS_SELECTION_LIST,
)
from win32comext.adsi.adsi import (
    error as error,
)

LCID: int
IDispatchType: Incomplete
IADsContainerType: Incomplete

class ADSIEnumerator:
    index: int
    def __init__(self, ob) -> None: ...
    def __getitem__(self, index): ...
    def __call__(self, index): ...

class ADSIDispatch(win32com.client.CDispatch):
    def __getattr__(self, attr: str): ...
    def QueryInterface(self, iid): ...

# Redefinition making "iid" optional.
def ADsGetObject(path, iid: _win32typing.PyIID = ...): ...

# Redefinition with flipped "reserved" and "iid" arguments.
def ADsOpenObject(path, username, password, reserved: int = ..., iid: _win32typing.PyIID = ...): ...
